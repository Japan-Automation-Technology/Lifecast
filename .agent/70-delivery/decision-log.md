# Decision Log

## 2026-02-12
- Product positioned as purchase-style crowdfunding with short-video-first UX.
- Initial category focus fixed to toC creative process-heavy projects (game/hardware priority).
- Funding mode fixed to all-or-nothing for MVP.
- Support conversion canonical definition fixed as payment success only.
- Funnel event sequence fixed with five required steps.
- Platform fee set to 15 percent (temporary fixed assumption).
- Payment processing fee assigned to creator.
- Refund economics and cancellation window baseline documented.
- Pre-publication checks, stop conditions, and 72-hour appeal baseline documented.
- MVP in-scope and out-of-scope boundaries frozen for first build.
- Store policy boundary frozen: MVP support targets physical return/reward outcomes only.
- Cancellation window fixed to 48 hours.
- Accounting approach frozen to append-only journal plus derived views.
- Full event sourcing rejected as MVP accounting source of truth.
- Dispute lifecycle bookkeeping and loss allocation required from MVP start.
- Managed video platform approach chosen for MVP (Cloudflare Stream baseline).
- Upload reliability baseline frozen: resumable sessions, dedupe guard, stuck-processing failure fallback.
- Payment error UX must map processor error categories to user actions.
- Native implementation split documented: independent iOS/Android lanes with shared backend contract governance.
- API contract rules v1 added with structured errors, idempotency, and webhook-authoritative settlement.
- Event contract v1 added with required fields, source-of-truth rules, and ingestion quality SLAs.
- OpenAPI draft added for Supports/Payments/Uploads/Journal/Disputes.
- PostgreSQL schema draft added for Support, UploadSession, Dispute, and double-entry Journal.
- MCP/Skills/secrets setup checklist documented for implementation readiness.
- Payout timing defaults frozen: next-business-day execution, target settlement within 2 business days, no rolling reserve in MVP.
- Store compliance baseline frozen: support flow restricted to physical rewards with explicit pre-checkout disclosures.
- High-trust report threshold and auto-review trigger defaults frozen.
- Event contract governance defaults frozen: backend/data lead ownership and semantic versioning.
- Log retention durations frozen by class (analytics, payments/journal, moderation/disputes, security audits).
- Notification matrix defaults frozen for creator/supporter/ops role-event channels.
- Dispute SLA defaults frozen (ack/triage/resolution/escalation targets).
- Low-conversion bitrate cap thresholds and recovery window frozen.
- M1 OpenAPI draft elevated to include payout read model, moderation report intake, dispute SLA view, and support policy snapshot.
- M1 DB draft elevated with payout schedules, moderation reports, notification events, and cancellation window enforcement.
- M1 execution ticket set created for backend/data/iOS/cross-cutting implementation.
- Monorepo workspace scaffold created for `apps/backend`, `apps/ios`, `apps/android`, `apps/web`, and `packages/contracts`.
- M1 backend API skeleton implemented with Fastify route groups and in-memory state adapter.
- Supports/Payments/Journal paths upgraded to hybrid persistence (Postgres-first with in-memory fallback for local resilience).
- Payout/dispute/moderation paths upgraded to hybrid persistence with DB-backed read/write and safe fallback.
- Webhook success path now enqueues creator/supporter notification events in DB transaction flow.
- Upload session paths upgraded to hybrid persistence with DB-backed create/complete/get and memory fallback.
- Notification worker skeleton added for DB-backed queue draining (`notification_events` -> `sent_at`).
- Backend app bootstrap split into reusable `buildApp()` for testability and contract-test injection.
- POST idempotency baseline added with `api_idempotency_keys` persistence + memory fallback.
- Stripe webhook dedupe baseline added with `processed_webhooks` table and route-level event parsing.
- Contract tests added for support prepare/confirm/webhook flow, idempotency conflict, and webhook dedupe.
- Migration/seed scripts wired (`db:migrate`, `db:seed`, `db:bootstrap`) with root aliases.
- Stripe webhook signature verification added (`LIFECAST_STRIPE_WEBHOOK_SECRET` with HMAC v1 check).
- Webhook event handlers expanded to include refund and dispute open/close transitions.
- Journal coverage expanded for `refund`, `dispute_open`, `dispute_close`, `loss_booking`, and `payout_release`.
- Reconciliation endpoint baseline added (`GET /v1/journal/reconciliation`) for provider-total delta checks.
- Event ingestion baseline added: event-contract validator + `analytics_events`/`analytics_event_dlq` persistence.
- `payment_succeeded` server event emit added after webhook-authoritative settlement.
- Payment smoke script added for real API flow validation (`smoke:payments:backend`).
- iOS starter API client scaffold added for support/upload API integration.
- Outbox baseline added (`outbox_events` + worker) for server event transport decoupling.
- Daily funnel/KPI analytics views and read APIs added for DA-002 baseline.
- Outbox delivery attempt logging added with retry metadata (`outbox_delivery_attempts`).
- Ops queue status endpoint added for backlog observability (`GET /v1/ops/queues`).
- Delivery runbooks baseline added for webhook/dispute/upload/notification incidents.

Cross-reference:
- `../00-executive/frozen-decisions.md`
- `../30-business-policy/payment-refund-policy.md`
- `../30-business-policy/dispute-and-liability-policy.md`
- `../30-business-policy/trust-and-safety-policy.md`
- `../50-data-analytics/funnel-definition.md`
- `../60-architecture/system-context.md`
- `../60-architecture/api-contract-rules.md`
- `../60-architecture/openapi-draft.yaml`
- `../60-architecture/db-schema-draft.sql`
- `./implementation-workbreakdown.md`
- `../50-data-analytics/event-contract-v1.md`
- `./mcp-skills-and-secrets-setup.md`
- `../40-mvp-spec/notification-matrix.md`
- `../50-data-analytics/logging-retention.md`
- `./m1-execution-tickets.md`

Last updated: 2026-02-12
